import{e,B as s,r as t,j as r}from"./index-C5loLNT9.js";import{n as o,k as n,o as i}from"./index-CbBQEXOZ.js";import{u}from"./useMutation-oZc7gSQE.js";import{r as c,b as a}from"./useGetUserCartItems-r_AZbCjz.js";import{S as d}from"./sweetalert2.esm.all-CrxasXBw.js";import{u as l}from"./useGetUser-B0ZVdZSb.js";import{C as m}from"./CircularProgress-CWxIx464.js";function f(){const s=e(),{user:t}=l(),{mutate:r,isPending:o}=u({mutationKey:["cart"],mutationFn:({productId:e})=>c({userId:null==t?void 0:t.id,productId:e}),onSuccess:()=>{s.invalidateQueries({queryKey:["cart"]})},onError:e=>{d.fire({title:e.message,icon:"error"})}});return{removeFromCartById:r,isPending:o}}function p({userId:c,cartProducts:d,productId:l,setIsSelected:p}){const{countUpdater:j,isPending:x}=function(){const t=e(),{mutate:r,isPending:o}=u({mutationFn:a,onSuccess:e=>{s.success("success",{autoClose:1e3}),t.invalidateQueries({queryKey:["cart"]}),t.setQueryData(["cart",e])},onError:e=>{s.error(e.message)}});return{countUpdater:r,isPending:o}}(),[v,h]=t.useState(1);t.useEffect((function(){var e;const s=null==(e=null==d?void 0:d.cart_items.find((e=>e.id===l)))?void 0:e.count;h(s)}),[null==d?void 0:d.cart_items,l]);const{removeFromCartById:I,isPending:b}=f(),y=x||b;return r.jsxs("div",{className:"flex h-[36.5px] items-center justify-between overflow-hidden rounded border bg-violet-50",children:[r.jsx("div",{className:"h-full",children:v>1?r.jsx("button",{type:"button",disabled:y,className:"h-full px-3",onClick:function(){v<=1||(h((e=>e-1)),j({count:v-1,userId:c,productId:l}))},children:r.jsx(o,{size:20})}):r.jsx("button",{className:"h-full px-3",type:"button",onClick:function(e){e.preventDefault(),I({productId:l,userId:c},{onSuccess:()=>{p&&p(!1),s.success("removed successfully",{position:"top-right",autoClose:3600})}})},children:r.jsx(n,{size:20})})}),r.jsx("span",{className:"font-extrabold",children:y?r.jsx(m,{size:12}):v}),r.jsx("div",{className:"h-full",children:r.jsx("button",{disabled:y,className:"h-full px-3",onClick:function(){h((e=>e+1)),j({count:v+1,userId:c,productId:l})},children:r.jsx(i,{size:20})})})]})}export{p as C,f as u};
