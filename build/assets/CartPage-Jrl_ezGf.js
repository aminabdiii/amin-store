import{j as e,b as s,B as t,L as r,e as i,N as a}from"./index-C5loLNT9.js";import{g as n,k as c,l}from"./index-CbBQEXOZ.js";import{c as o,u as x}from"./useGetUserCartItems-r_AZbCjz.js";import{F as d}from"./index-CQsUyfF_.js";import{u as m}from"./useGetUser-B0ZVdZSb.js";import{u,C as p}from"./CounterSection-BScYejLy.js";import{u as j}from"./useMutation-oZc7gSQE.js";import{i as f,C as h}from"./purchasesApi-BcfmRHYA.js";import{C as g}from"./Container-B6ePsMKV.js";import{L as b}from"./Loader--f3UfDqb.js";import{S as y}from"./sweetalert2.esm.all-CrxasXBw.js";import{c as N}from"./createSvgIcon-Bci2w0Kx.js";import{_ as v}from"./lodash-B0Q_iIZZ.js";import{B as w}from"./Button-B9qqcjJ9.js";import"./useQuery-cduBLe5R.js";import"./useBaseQuery-Dhpcymqo.js";import"./supabase-ClnIyvqL.js";import"./CircularProgress-CWxIx464.js";import"./DefaultPropsProvider-DdaabJBK.js";import"./createSimplePaletteValueFilter-BwloS0Cl.js";import"./emotion-react.browser.esm-B7H-_Xiz.js";import"./index-BUwTo0eB.js";import"./ButtonBase-CMk9oDBr.js";import"./TransitionGroupContext-oF5BF2eg.js";const C=N(e.jsx("path",{d:"M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12s4.48 10 10 10 10-4.48 10-10m-10 1H8v-2h4V8l4 4-4 4z"}),"ArrowCircleRight");function z({icon:s,title:t}){return e.jsxs("h2",{className:"base-gradient flex items-center gap-2 text-nowrap rounded-t-3xl bg-gradient-to-br px-4 py-3 font-bold capitalize text-white",children:[s,e.jsx("span",{children:t})]})}function F({src:s,alt:t,path:i}){return e.jsx(r,{to:i,children:e.jsx("img",{className:"w-full",src:s,alt:t})})}function P({children:s}){return e.jsx("div",{className:"flex h-full max-w-32 flex-col gap-3 px-3 xxs:max-w-36 xs:max-w-52 md:max-w-56",children:s})}function I({children:s}){return e.jsx("div",{className:"relative flex items-center justify-between gap-3 py-5",children:s})}function B({count:s,price:t,discount:r}){const i=r?Math.floor(t-t*r/100):t;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-0.5 text-lg font-bold 450:text-xl sm:text-2xl",children:[e.jsx(d,{className:"text-green-400"}),e.jsxs("div",{className:"flex gap-1.5 pb-px",children:[null==i?void 0:i.toFixed(2),e.jsxs("div",{children:[e.jsx(h,{})," ",s]})]})]}),r>0&&e.jsx("div",{children:e.jsx("span",{className:"block pb-px text-[11px] font-semibold text-gray-400 line-through 450:text-sm",children:null==t?void 0:t.toFixed(2)})})]})}function D({size:s,color:t,category:r,warranty:i}){return e.jsxs("div",{className:"flex flex-col gap-1 text-sm 450:text-base",children:[s&&e.jsxs("div",{children:[e.jsx("span",{children:"size: "}),e.jsx("span",{className:"font-bold uppercase",children:s})]}),t&&e.jsxs("div",{children:[e.jsx("span",{children:"color: "}),e.jsx("span",{className:"font-bold uppercase",children:t})]}),i&&e.jsxs("div",{children:[e.jsx("span",{children:"warranty: "}),e.jsx("span",{className:"font-bold uppercase",children:i})]}),e.jsxs("div",{children:[e.jsx("span",{children:"category: "}),e.jsx("span",{className:"font-bold uppercase",children:r})]})]})}function S({path:s,title:t}){return e.jsx(r,{to:s,className:"line-clamp-2 text-pretty text-sm font-semibold 450:text-base sm:text-lg",children:t})}function _({children:s}){return e.jsx("div",{className:"basis-full md:basis-2/3",children:s})}function k({className:s}){return e.jsxs("section",{className:`mx-auto my-5 flex max-w-7xl flex-col items-center justify-center gap-10 border bg-gray-50 px-3 font-medium capitalize ${s}`,children:[e.jsx("img",{src:"empty-cart.png",alt:"empty-cart",className:"w-10/12 max-w-[280px]"}),e.jsx("h3",{className:"text-lg xxs:text-xl vxs:text-2xl",children:"your shopping cart is empty"}),e.jsxs(r,{to:"/products",className:"rounded-full bg-violet-500 p-3 text-base text-white xxs:text-lg vxs:text-xl",children:["products page ",e.jsx(C,{})]})]})}function L(){const r=i(),{cartProducts:h,isLoading:N}=x(),{user:C,isLoading:L}=m(),{removeFromCartById:M,isPending:G}=u(),{insertPurchases:A}=function(){const e=s(),{mutate:r}=j({mutationFn:f,onSuccess(){t.success("Your order has been registered",{autoClose:2e3}),e("/userPanel/purchases")},onError(e){t.error(e.message)}});return{insertPurchases:r}}(),{clearCart:Q}=function(){const{user:e}=m(),{mutate:s}=j({mutationFn:()=>o({userId:null==e?void 0:e.id})});return{clearCart:s}}();if(N||L)return e.jsx(g,{children:e.jsx(b,{})});if(!h&&!N&&!L)return y.fire({icon:"info",title:"Please first log in or sign up to the website"}),e.jsx(a,{to:"/sign-in",replace:!0});if(!h.cart_items.length)return e.jsx(k,{className:"min-h-[35rem]"});const T=v.reduce(h.cart_items,((e,s)=>(e+s.price)*s.count),0),$=v.reduce(h.cart_items,((e,s)=>(s.price-s.price*s.discount/100)*s.count+e),0),H=v.some(h.cart_items,(e=>e.discount)),U=Math.floor((T-$)/T*100),V=h.cart_items.sort(((e,s)=>s.price-e.price));return e.jsxs("section",{className:"mx-auto my-5 flex max-w-7xl flex-col gap-5 px-3 md:flex-row md:justify-between",children:[e.jsx(e.Fragment,{children:e.jsxs(_,{children:[e.jsx(z,{title:"shopping card",icon:e.jsx(n,{size:30})}),e.jsx("div",{className:"flex min-h-[80dvh] flex-col gap-3 divide-y border",children:V.map((s=>{const{title:r,price:i,size:a,image:n,discount:l,colors:o,warranty:x,category:d,id:m,count:u}=s;return e.jsxs(I,{children:[e.jsxs(P,{children:[e.jsx(F,{src:n,alt:r,path:`/DetailsProduct?productId=${m}`}),e.jsx(p,{cartProducts:h,productId:m,userId:C.id})]}),e.jsxs("div",{className:"flex h-full flex-grow flex-col gap-3 pr-3",children:[e.jsx(S,{title:r,path:`/DetailsProduct?productId=${m}`}),e.jsx(B,{count:u,price:i,discount:l}),e.jsx(D,{category:d,color:o,size:a,warranty:x}),e.jsx(w,{onClick:()=>function({productId:e}){y.fire({title:"Are you sure you want to remove this item from your cart?",icon:"warning",showDenyButton:!0,showConfirmButton:!0,confirmButtonText:"yes"}).then((s=>{s.isConfirmed&&M({productId:e,userId:C.id},{onSuccess:()=>t.success("remove successfully")})}))}({productId:m}),disabled:G,size:"small",variant:"contained",color:"error",className:"!mt-2 !self-end !font-montserrat !text-[10px] 450:!text-base",startIcon:e.jsx(c,{className:"h-3 w-3 450:h-5 450:w-5"}),children:"Delete"})]})]},r)}))})]})}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"sticky top-[100px] h-full basis-full md:basis-1/3 md:self-start",children:[e.jsx(e.Fragment,{children:e.jsx(z,{title:"Payment information",icon:e.jsx(l,{size:30})})}),e.jsxs("div",{className:"border px-3 py-5",children:[e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-6 border-b pb-5",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 text-gray-700",children:[e.jsx("h4",{className:"text-sm font-semibold capitalize",children:"total price"}),e.jsxs("span",{className:"flex items-center gap-1 text-base font-semibold",children:[T.toFixed(2),e.jsx(d,{size:18})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 text-red-500",children:[e.jsxs("h4",{className:"text-sm font-semibold capitalize",children:["discounted price (",U,"%)"]}),e.jsxs("span",{className:"flex items-center gap-1 text-base font-semibold",children:[$.toFixed(2),e.jsx(d,{size:18})]})]})]})}),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center justify-between pt-5 text-gray-950",children:[e.jsx("h4",{className:"text-xl font-semibold capitalize",children:"bill:"}),e.jsxs("span",{className:"flex items-center gap-1 text-2xl font-bold",children:[H?$.toFixed(2):T.toFixed(2),e.jsx(d,{size:18})]})]})}),e.jsx(e.Fragment,{children:e.jsx("div",{children:e.jsx(w,{onClick:function(){let e=new Date;const s=v.reduce(h.cart_items,((e,s,t,r)=>e+s.postType/r.length),0);e.setDate(e.getDate()+Math.floor(s)),A({delivery_date:e,products:h.cart_items,userId:C.id,totalPrice:$},{onSuccess(){Q(),r.setQueryData(["cart"],h)}})},size:"large",variant:"contained",className:"!mt-5 w-full !rounded-full !bg-green-400 !font-montserrat !text-[10px] 450:!text-base",children:"Complete Purchase"})})})]})]})})]})}function M(){return e.jsx(L,{})}export{M as default};
